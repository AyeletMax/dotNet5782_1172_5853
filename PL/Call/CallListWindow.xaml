<!--<Window x:Class="PL.Call.CallListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PL"
        mc:Ignorable="d"
        Title="Call Management" Height="680" Width="1000"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FDF5F7" Offset="0"/>
            <GradientStop Color="#E6F7FD" Offset="1"/>
        </LinearGradientBrush>
    </Window.Background>

    --><!-- משאבים --><!--
    <Window.Resources>
        --><!-- רשימות סטטוס וסוג קריאה יקבלו ItemsSource מקוד‑המאחורי --><!--
        <BooleanToVisibilityConverter x:Key="Bool2Vis"/>

        --><!-- סגנונות כלליים (ממחזרים את אלו של volunteer window) --><!--
        <Style x:Key="RoundButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#5C6BC0"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="20"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="RowBackground" Value="White"/>
            <Setter Property="AlternatingRowBackground" Value="#FAFAFA"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#3F51B5"/>
        </Style>

        <Style x:Key="CenteredText" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    --><!-- פריסה --><!--
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        --><!-- כותרת --><!--
        <TextBlock Grid.Row="0"
                   Text=" Call Management"
                   FontSize="26"
                   FontWeight="Bold"
                   Foreground="#3F51B5"
                   HorizontalAlignment="Center"
                   Margin="0,10"/>

        --><!-- פס מיון/סינון/קיבוץ --><!--
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,10">
            --><!-- סינון סטטוס --><!--
            <StackPanel Orientation="Vertical" Margin="10">
                <TextBlock Text="Filter by Status:" FontSize="12" Margin="2"/>
                <ComboBox Width="160" Height="28"
                          ItemsSource="{Binding StatusList}"
                          SelectedValue="{Binding SelectedStatus, Mode=TwoWay}"/>
            </StackPanel>

            --><!-- סינון סוג קריאה --><!--
            <StackPanel Orientation="Vertical" Margin="10">
                <TextBlock Text="Filter by Call Type:" FontSize="12" Margin="2"/>
                <ComboBox Width="160" Height="28"
                          ItemsSource="{Binding CallTypeList}"
                          SelectedValue="{Binding SelectedCallType, Mode=TwoWay}"/>
            </StackPanel>

            --><!-- מיון --><!--
            <StackPanel Orientation="Vertical" Margin="10">
                <TextBlock Text="Sort By:" FontSize="12" Margin="2"/>
                <ComboBox Width="160" Height="28"
                          ItemsSource="{Binding SortFieldList}"
                          SelectedValue="{Binding SelectedSortField, Mode=TwoWay}"/>
            </StackPanel>

            --><!-- קיבוץ (אופציונלי) --><!--
            <StackPanel Orientation="Vertical" Margin="10">
                <TextBlock Text="Group By:" FontSize="12" Margin="2"/>
                <ComboBox Width="160" Height="28"
                          ItemsSource="{Binding GroupFieldList}"
                          SelectedValue="{Binding SelectedGroupField, Mode=TwoWay}"/>
            </StackPanel>
        </StackPanel>

        --><!-- טבלת קריאות --><!--
        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding CallList}"
                  SelectedItem="{Binding SelectedCall}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  MouseDoubleClick="dgCallList_MouseDoubleClick"
                  HorizontalAlignment="Center">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID"
                                    Binding="{Binding Id}"
                                    Width="60"
                                    ElementStyle="{StaticResource CenteredText}"/>

                <DataGridTextColumn Header="Status"
                                    Binding="{Binding Status}"
                                    Width="130"
                                    ElementStyle="{StaticResource CenteredText}"/>

                <DataGridTextColumn Header="Time Left"
                                    Binding="{Binding TimeRemaining}"
                                    Width="120"
                                    ElementStyle="{StaticResource CenteredText}"/>

                <DataGridTextColumn Header="Total Handling Time"
                                    Binding="{Binding TimeHandled}"
                                    Width="160"
                                    ElementStyle="{StaticResource CenteredText}"/>

                <DataGridTextColumn Header="Last Volunteer"
                                    Binding="{Binding LastVolunteerName}"
                                    Width="150"
                                    ElementStyle="{StaticResource CenteredText}"/>

                <DataGridTextColumn Header="#Assignments"
                                    Binding="{Binding AssignmentCount}"
                                    Width="120"
                                    ElementStyle="{StaticResource CenteredText}"/>

                --><!-- כפתור ביטול הקצאה --><!--
                <DataGridTemplateColumn Header="Cancel"
                                         Width="70">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="🔄"
                                    ToolTip="Cancel current assignment"
                                    Click="CancelAssignButton_Click"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    FontSize="16"
                                    Visibility="{Binding CanCancelAssignment,
                                                         Converter={StaticResource Bool2Vis}}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                --><!-- כפתור מחיקה --><!--
                <DataGridTemplateColumn Header="Delete"
                                         Width="60">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="🗑"
                                    ToolTip="Delete call"
                                    Click="DeleteButton_Click"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    FontSize="16"
                                    Visibility="{Binding CanDelete,
                                                         Converter={StaticResource Bool2Vis}}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        --><!-- כפתור הוספה --><!--
        <Button Grid.Row="3"
                Content="➕  Add Call"
                Click="btnAdd_Click"
                Style="{StaticResource RoundButtonStyle}"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"/>
    </Grid>
</Window>-->
<Window x:Class="PL.Call.CallListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:local="clr-namespace:PL"
        mc:Ignorable="d"
        Title="Call Management" Height="640" Width="900"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Background>
        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#F3F6FD" Offset="0.0"/>
            <GradientStop Color="#FDE4EC" Offset="1.0"/>
        </LinearGradientBrush>
    </Window.Background>

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#5C6BC0"/>

            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                            CornerRadius="12"
                            Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- סגנון תוויות -->
        <Style TargetType="Label">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="Foreground" Value="#333"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <!-- סגנון לטקסטבוקסים -->
        <Style TargetType="TextBox">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="BorderBrush" Value="plum"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
        </Style>
    </Window.Resources>


    <Grid>
        
        <Grid.RowDefinitions>
            <RowDefinition Height="40*"/>
            <RowDefinition Height="500*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid HorizontalAlignment="Stretch" Height="auto" Grid.Row="0" VerticalAlignment="Stretch" Width="auto">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="*"/>

            </Grid.ColumnDefinitions>
            <!--<Label Content="Call Management" HorizontalContentAlignment="Center" Grid.Column="0" Height="25" VerticalAlignment="Top"/>-->
            <!--<ComboBox HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>-->
            <TextBlock Grid.Row="0" Grid.Column="1" Text="&#x1F3B5; Call List for Music &amp; Singing &#x1F3B5;"
                FontSize="24" FontWeight="Bold" Foreground="#3F51B5"
                HorizontalAlignment="Center" Margin="0,10"/>
            <ComboBox 
            SelectedValue="{Binding CallType, Mode=TwoWay}"
            SelectionChanged="comboBoxFilterCallType_SelectionChanged" 
            ItemsSource="{Binding Source={StaticResource CallTypeCollection}}" Margin="86,0,0,750" Grid.Column="1" RenderTransformOrigin="0.5,0.5">
            </ComboBox>

            <Label Content="status" HorizontalContentAlignment="Center" Grid.Column="2" Margin="0,0,0,409"/>
            <ComboBox
            Grid.Column="2" 
            SelectedValue="{Binding CallStatus, Mode=TwoWay}"
            SelectionChanged="comboBoxFilterCallStatus_SelectionChanged" 
            ItemsSource="{Binding Source={StaticResource CallStatusCollection}}" Margin="86,0,0,750"/>

        </Grid>
        <DataGrid
            Grid.Row="1"
        ItemsSource="{Binding CallList}"
        IsReadOnly ="True" 
        AutoGenerateColumns="False"
      	    EnableRowVirtualization="True"
        RowDetailsVisibilityMode="VisibleWhenSelected"
        MouseDoubleClick="DataGrid_MouseDoubleClick"
        SelectedItem="{Binding SelectedCall}" Margin="0,63,0,63">
        <DataGrid.Columns>
            <DataGridTextColumn Binding="{Binding CallId}" Header="CallId" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding CallType}" Header="CallType" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding OpeningTime}" Header="OpeningTime" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding TimeLeft}" Header="TimeLeft" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding LastVolunteerName}" Header="LastVolunteerName" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding TotalTime}" Header="TotalTime" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding CallStatus}" Header="CallStatus" Width="Auto"/>
            <DataGridTextColumn Binding="{Binding TotalAssignments}" Header="TotalAssignments" Width="Auto"/>
            <DataGridTemplateColumn Header="Unassign" Width="Auto">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Button Content="Unassign" Click="btnUnassignCall_Click"/>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            <DataGridTemplateColumn Header="Delete" Width="Auto">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Button Content="Delete" Click="btnDeleteCall_Click"  />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
        </DataGrid.Columns>

        </DataGrid>
        <Button Grid.Row="3"
        Content="➕  Add Call"
        Click="btnAdd_Click"
        HorizontalAlignment="Center"
        VerticalAlignment="Center"/>
    </Grid>
</Window>