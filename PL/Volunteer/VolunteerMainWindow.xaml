<Window x:Class="VolunteerSystem.VolunteerMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:VolunteerSystem"
        Title="בחירת קריאות פתוחות" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        FlowDirection="RightToLeft">
    
    
      

    <Window.Resources>
        <!-- סגנונות -->
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2C3E50"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <Style x:Key="ButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#3498DB"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2980B9"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SelectButtonStyle" TargetType="Button" BasedOn="{StaticResource ButtonStyle}">
            <Setter Property="Background" Value="#27AE60"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#229954"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="FilterComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="MinWidth" Value="120"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="300"/>
        </Grid.RowDefinitions>

        <!-- כותרת -->
        <TextBlock Grid.Row="0" Text="קריאות פתוחות לטיפול" 
                   FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Center" 
                   Margin="10" Foreground="#2C3E50"/>

        <!-- פאנל סינון ומיון -->
        <Border Grid.Row="1" Background="#ECF0F1" Padding="10" Margin="5">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <TextBlock Text="סינון לפי סוג קריאה:" Style="{StaticResource HeaderTextStyle}" VerticalAlignment="Center"/>
                <ComboBox x:Name="CallTypeFilterComboBox" Style="{StaticResource FilterComboBoxStyle}"
                          SelectionChanged="CallTypeFilter_SelectionChanged"/>

                <TextBlock Text="מיון לפי:" Style="{StaticResource HeaderTextStyle}" VerticalAlignment="Center" Margin="20,5,5,5"/>
                <ComboBox x:Name="SortFieldComboBox" Style="{StaticResource FilterComboBoxStyle}"
                          SelectionChanged="SortField_SelectionChanged"/>

                <Button x:Name="RefreshButton" Content="רענן רשימה" Style="{StaticResource ButtonStyle}"
                        Click="RefreshButton_Click" Margin="20,5,5,5"/>

                <Button x:Name="UpdateAddressButton" Content="עדכן כתובת" Style="{StaticResource ButtonStyle}"
                        Click="UpdateAddressButton_Click"/>
            </StackPanel>
        </Border>

        <!-- רשימת הקריאות -->
        <DataGrid x:Name="OpenCallsDataGrid" Grid.Row="2" 
                  AutoGenerateColumns="False" 
                  SelectionMode="Single"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeRows="False"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  SelectionChanged="OpenCallsDataGrid_SelectionChanged"
                  Margin="10">

            <DataGrid.Columns>
                <DataGridTextColumn Header="מספר קריאה" Binding="{Binding Id}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="סוג קריאה" Binding="{Binding MyCallType}" Width="100" IsReadOnly="True"/>
                <DataGridTextColumn Header="כתובת" Binding="{Binding Address}" Width="200" IsReadOnly="True"/>
                <DataGridTextColumn Header="זמן פתיחה" Binding="{Binding OpenTime, StringFormat='dd/MM/yyyy HH:mm'}" Width="120" IsReadOnly="True"/>
                <DataGridTextColumn Header="זמן סיום מקסימלי" Binding="{Binding MaxFinishTime, StringFormat='dd/MM/yyyy HH:mm'}" Width="130" IsReadOnly="True"/>
                <DataGridTextColumn Header="מרחק (ק״מ)" Binding="{Binding distanceFromVolunteerToCall, StringFormat=F2}" Width="80" IsReadOnly="True"/>

                <DataGridTemplateColumn Header="פעולה" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="בחר לטיפול" 
                                    Style="{StaticResource SelectButtonStyle}"
                                    Click="SelectCallButton_Click"
                                    Tag="{Binding Id}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- פאנל התיאור והמפה -->
        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="300"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- תיאור הקריאה -->
            <Border Grid.Column="0" Background="#F8F9FA" BorderBrush="#DEE2E6" BorderThickness="1" Margin="10">
                <StackPanel Margin="10">
                    <TextBlock Text="פירוט הקריאה הנבחרת" Style="{StaticResource HeaderTextStyle}" HorizontalAlignment="Center"/>
                    <Separator Margin="0,5"/>
                    <ScrollViewer MaxHeight="200" VerticalScrollBarVisibility="Auto">
                        <TextBlock x:Name="CallDescriptionTextBlock" 
                                   TextWrapping="Wrap" 
                                   Text="בחר קריאה מהרשימה כדי לראות את הפירוט"
                                   FontSize="12"
                                   Margin="5"/>
                    </ScrollViewer>
                </StackPanel>
            </Border>

            <!-- מפה -->
            <Border Grid.Column="1" Background="White" BorderBrush="#DEE2E6" BorderThickness="1" Margin="10">
                <Grid>
                    <TextBlock x:Name="MapPlaceholder" 
                               Text="מפה תוצג כאן&#x0A;(דורש שילוב עם Google Maps או Bing Maps)"
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               FontSize="14" 
                               Foreground="Gray"
                               TextAlignment="Center"/>

                    <!-- כאן ניתן להוסיף WebBrowser או Map control -->
                    <WebBrowser x:Name="MapWebBrowser" Visibility="Collapsed"/>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>